<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="UTF-8">
  <link href="http://gmpg.org/xfn/11" rel="profile">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>
    
      Mark Hermsdorfer &middot; 
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/styles.css">

  <!-- RSS -->
  <link rel="alternate" type="application/atom+xml" title="Mark Hermsdorfer" href="/atom.xml">
</head>



    <body>

    <header class="site-header">

  <div class="wrap">

    <a class="site-title" href="/">Mark Hermsdorfer</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        
          
            
              <a class="page-link" href="/about/">About</a>
            
          
        
          
        
          
            
              <a class="page-link" href="/">Home</a>
            
          
        
          
        
          
            
            
          
        
          
            
            
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrap">
         <div class="post-content">
           <div class="posts">
  
  <article class="post">
    <h1 class="post-title">
      <a href="/f5/ltm/afm/2018/06/04/Source-MAC-based-routing/">
        Source MAC based routing
      </a>
    </h1>

    <time datetime="2018-06-04T06:54:25-04:00" class="post-date">04 Jun 2018</time>

    <p>Several network/firwall vendors offer a feature that overrides the routing table to return traffic to the MAC address that initiated the connection.  The idea here is to store the MAC address that the SYN packet came from in the connection table, then when sending return traffic for that flow, to send it to the MAC address that the SYN came from.  This overrides the destination based routing table and helps prevent asymmetrical routing.  Depending upon your point of view, this is either very helpful or very confusing.</p>

<p>This post simply catalogs the names various vendors call this feature.  There is no standard name, as such it can be very confusing when talking with different vendors.</p>

<table>
  <thead>
    <tr>
      <th>Vendor</th>
      <th>Feature Name</th>
      <th>Documentation Link</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>F5 Networks</td>
      <td>Auto Last Hop (ALH)</td>
      <td><a href="https://support.f5.com/csp/article/K13876">K13876: Overview of the Auto Last Hop setting</a></td>
    </tr>
    <tr>
      <td>Palo Alto</td>
      <td>Symmetric Return</td>
      <td><a href="https://live.paloaltonetworks.com/t5/Configuration-Articles/How-to-Configure-Symmetric-Return/ta-p/59374">How to Configure Symmetric Return</a></td>
    </tr>
    <tr>
      <td>BlueCoat</td>
      <td>Return-To-Sender (RTS)</td>
      <td><a href="https://origin-symwisedownload.symantec.com/resources/webguides/cacheflow/3x/3_4/webguide/Content/CLI/config_return-to-send.htm">RTS CLI Reference</a></td>
    </tr>
    <tr>
      <td>Check Point</td>
      <td>unsure</td>
      <td>I’m pretty sure this feature exists for checkpoint, however I can’t find it’s name</td>
    </tr>
  </tbody>
</table>

  </article>
  
  <article class="post">
    <h1 class="post-title">
      <a href="/f5/ltm/2015/07/09/f5-status-page/">
        Server status pages for F5 monitoring
      </a>
    </h1>

    <time datetime="2015-07-09T06:54:25-04:00" class="post-date">09 Jul 2015</time>

    <p>Automation is critical in our industry, however many companies opt for a less technically advanced self service play.  One trivially easy way to get some self-service with the F5 platform is though the use of status pages for pool member monitoring.</p>

<p>In this scenario the application or server administrators setup a status page, that status page can be as complex as the application or server administrators like.  On the higher end it could be a jsp page that checks the status of various other services and databases reporting overall application health.  On the lower end it can be a simple static html page.</p>

<p>By modifying the output of the status page the application administrators can indicate to the F5 if traffic should be sent to the server.  This allows server &amp; application team members to perform maintenance on their servers without involvement from the F5 operators to disable pool member.</p>

<p>For more details on monitor regex strings: <a href="https://support.f5.com/kb/en-us/solutions/public/5000/900/sol5917.html">Using regular expressions in a health monitor Receive String</a></p>

<p>For more details on monitor disable strings: <a href="https://support.f5.com/kb/en-us/solutions/public/12000/800/sol12818.html">Using the Receive Disable String advanced configuration setting</a></p>

<h2 id="configuration-example">Configuration example</h2>

<p>Here is an example static status page I’ve used previously.  There is nothing complex, it includes some details so operators can see their various status options.</p>

<div class="highlight"><pre><code class="language-html" data-lang="html"><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&quot;content-type&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;text/html; charset=UTF-8&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span> Application Status Page <span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span> Application Status Page <span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span> status=up <span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>

    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span> Modify the current server status on header above, leaving no space between status= and expected status.  The server status can be set to various options as follows:
    <span class="p">&lt;</span><span class="nt">ul</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span> up or online:     Server is normal and eligible for all traffic. <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span> quiesce or drain: Server is going offline and eligible only for existing sessions. <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;</span> down or offline:  Server is down and not eligible any traffic. <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></code></pre></div>

<p>Here is an example HTTP status monitor on the F5 that works with the above status page.</p>

<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>ltm monitor http /Common/status-http-monitor {
    adaptive disabled
    defaults-from /Common/http
    destination *:*
    interval 5
    ip-dscp 0
    recv &quot;status=(up|online)&quot;
    recv-disable &quot;status=(quiesce|disabled|drain)&quot;
    send &quot;GET /status.html HTTP/1.1\\r\\nHost: status.com\\r\\nConnection: close\\r\\n\\r\\n&quot;
    time-until-up 0
    timeout 16
}</code></pre></div>

<p>The same monitor as above, except this one is for HTTPS.</p>

<div class="highlight"><pre><code class="language-text" data-lang="text"><span></span>ltm monitor https /Common/status-https-monitor {
    adaptive disabled
    cipherlist DEFAULT:+SHA:+3DES:+kEDH
    compatibility enabled
    defaults-from /Common/https
    destination *:*
    interval 5
    ip-dscp 0
    recv &quot;status=(up|online)&quot;
    recv-disable &quot;status=(quiesce|disabled|drain)&quot;
    send &quot;GET /status.html HTTP/1.1\\\\r\\\\nHost: status.com\\\\r\\\\nConnection: close\\\\r\\\\n\\\\r\\\\n&quot;
    time-until-up 0
    timeout 16
}</code></pre></div>


  </article>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page2">Older</a>
  
  
    <span class="pagination-item newer">Newer</span>
  
</div>

<aside class="related">
  <h2>Recent Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/f5/ltm/afm/2018/06/04/Source-MAC-based-routing/">
            Source MAC based routing
            <small><time datetime="2018-06-04T06:54:25-04:00">04 Jun 2018</time></small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/f5/ltm/2015/07/09/f5-status-page/">
            Server status pages for F5 monitoring
            <small><time datetime="2015-07-09T06:54:25-04:00">09 Jul 2015</time></small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/f5/ltm/2015/07/08/ssl-bridging-and-clone-pool/">
            LTM clone pools & SSL Bridging
            <small><time datetime="2015-07-08T06:54:25-04:00">08 Jul 2015</time></small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/f5/gtm/2014/12/23/GTM-Translation-addresses-for-Generic-Host-objects/">
            GTM Translation addresses for Generic Host objects
            <small><time datetime="2014-12-23T12:54:25-05:00">23 Dec 2014</time></small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/f5/gtm/2014/12/23/split-dns-with-gtm/">
            Split DNS with GTM
            <small><time datetime="2014-12-23T10:32:34-05:00">23 Dec 2014</time></small>
          </a>
        </h3>
      </li>
    
  </ul>
</aside>

         </div>
      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">

    <h2 class="footer-heading">Mark Hermsdorfer</h2>

    <div class="footer-col-1 column">
      <ul>
        <li>Mark Hermsdorfer</li>
        <li><a href="mailto:mark@hermsdorfer.net">mark@hermsdorfer.net</a></li>
      </ul>
    </div>

    <div class="footer-col-2 column">
      <ul>
        <li>
          <a href="https://github.com/mhermsdorfer">
            <span class="icon github">
              <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
              </svg>
            </span>
            <span class="username">mhermsdorfer</span>
          </a>
        </li>
        
      </ul>
    </div>

    <div class="footer-col-3 column">
      <p class="text">Hi, I'm Mark Hermsdorfer, an operations architect with a focus on networking and application delivery infrastructure.  I write about various topics including my time as an F5 Networks consultant.</p>
    </div>

  </div>

</footer>


    </body>
</html>
